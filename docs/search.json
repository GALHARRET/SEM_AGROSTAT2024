[
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Stuctural Equation Modeling",
    "section": "",
    "text": "Introduction\nThis AGROSTAT2024 pre-conference workshop was held on 3 September 2024 in Bragança. All its material is available at https://galharret.github.io/SEM_AGROSTAT2024/"
  },
  {
    "objectID": "index.html#what-is-a-structural-equation-model",
    "href": "index.html#what-is-a-structural-equation-model",
    "title": "Stuctural Equation Modeling",
    "section": "What is a structural equation model?",
    "text": "What is a structural equation model?\n\nStructural equation modeling generalizes linear regression models.\nThese models have been introduced into social and psychological studies in the 70’s.\nSEM can be used to produce regression models between latent variables."
  },
  {
    "objectID": "index.html#the-two-approaches",
    "href": "index.html#the-two-approaches",
    "title": "Stuctural Equation Modeling",
    "section": "The two approaches",
    "text": "The two approaches\n\nCovariance Analysis: Jöreskog (1970)\nPartial Least Square (PLS): Wold (1980)\n\n\\(\\leadsto\\) In this workshop we will focus on the covariance analysis with the most theoritical and mathematical background.\n\n\n\n\n\nJöreskog\n\n\n\n\n\n\nWold"
  },
  {
    "objectID": "index.html#the-reference-books",
    "href": "index.html#the-reference-books",
    "title": "Stuctural Equation Modeling",
    "section": "The reference books",
    "text": "The reference books\n\n\n\n\n\nBollen (1989)\n\n\n\n\n\n\nKline (2023)\n\n\n\n\n\n\nChen and Yung (2024)"
  },
  {
    "objectID": "index.html#contents-of-the-workshop",
    "href": "index.html#contents-of-the-workshop",
    "title": "Stuctural Equation Modeling",
    "section": "Contents of the workshop",
    "text": "Contents of the workshop\n\nSEM without a measurement model: Path modeling\nSEM with a measurement model: Factor Analysis and structural relation."
  },
  {
    "objectID": "index.html#sem-terminology-and-notations",
    "href": "index.html#sem-terminology-and-notations",
    "title": "Stuctural Equation Modeling",
    "section": "SEM Terminology and Notations",
    "text": "SEM Terminology and Notations\nIn SEM, two categories of variables are involved:\n\nExogenous variable (denoted by \\(\\xi\\)) who are deterministic. These values are independent from the values of the other variables of the model. Normal regression models assume that the predictors are exogenous.\nEndogenous variable (denoted by \\(\\eta\\)) who are stochastic and who are correlated with the error of the model. These values are depending of the values of other factors involved in the model.\n\nIn the first example \\(X_1\\) is exogenous and \\(X_2,X_3\\) are endogenous."
  },
  {
    "objectID": "index.html#software",
    "href": "index.html#software",
    "title": "Stuctural Equation Modeling",
    "section": "Software",
    "text": "Software\nLavaan is a the most popular package on R for latent variable modelling.\n\nThe official reference of lavaan: Rosseel (2012)\nIts website : lavaan.org\nFor installing lavaan :\n\n\ninstall.packages(\"lavaan\", dependencies = TRUE)\n\n\n\n\n\nBollen, Kenneth A. 1989. Structural Equations with Latent Variables. 1st ed. Wiley. https://doi.org/10.1002/9781118619179.\n\n\nChen, Ding-Geng, and Yiu-Fai Yung. 2024. Structural Equation Modeling Using r/SAS: A Step-by-Step Approach with Real Data Analysis. First edition. Boca Raton: CRC Press.\n\n\nJöreskog, K. G. 1970. “A General Method for Analysis of Covariance Structures.” Biometrika 57 (2): 239–51. https://doi.org/10.1093/biomet/57.2.239.\n\n\nKline, Rex B. 2023. Principles and Practice of Structural Equation Modeling. Fifth edition. Methodology in the Social Sciences. New York: The Guilford Press.\n\n\nRosseel, Yves. 2012. “Lavaan : An R Package for Structural Equation Modeling.” Journal of Statistical Software 48 (2). https://doi.org/10.18637/jss.v048.i02.\n\n\nWold, Herman. 1980. “Model Construction and Evaluation When Theoretical Knowledge Is Scarce.” In, 47–74. National Bureau of Economic Research, Inc. https://EconPapers.repec.org/RePEc:nbr:nberch:11693."
  },
  {
    "objectID": "chapter1.html#limits-of-regression-model",
    "href": "chapter1.html#limits-of-regression-model",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.1 Limits of regression model",
    "text": "1.1 Limits of regression model\nRegression models are popular for testing linear relationship between continous predictors and continous outcome.\nHowever, in this framework :\n\nPredictors are measured without errors.\nFor example, some systems of regression equations cannot be tested:"
  },
  {
    "objectID": "chapter1.html#assumptions",
    "href": "chapter1.html#assumptions",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.2 Assumptions",
    "text": "1.2 Assumptions\nWe assume that the errors \\(\\zeta_\\bullet\\) are not correlated.\nMoreover, by definition of exogenous variables,\nthe errors \\(\\zeta_\\bullet\\) and the exogenous variables \\(x_\\bullet\\) of the model are not correlated.\nFor simplification, we assume that endogenous and exogenous variables are standardized, that is\n\\[\\mathbb{E}(x_\\bullet)=\\mathbb{E}(y_\\bullet)=0, \\quad \\mathbb{V}(x_\\bullet)=\\mathbb{V}(y_\\bullet)=1.\\]\n\n1.2.1 Remark :\nThis assumption is not necessary in the applications; it only serves to simplify the mathematical expression of the covariance matrix."
  },
  {
    "objectID": "chapter1.html#diagram-of-a-path",
    "href": "chapter1.html#diagram-of-a-path",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.3 Diagram of a path",
    "text": "1.3 Diagram of a path\n\n\n\n\n\n\n\n\nA path model can be summarized by a diagram. In the left, the diagram describes a mediation model with an exogenous variable \\(x_1\\), a mediator \\(y_1\\) and an outcome \\(y_2\\).\n\n\nThis diagram represents the following system\n\\[\n\\begin{cases}\ny_1=\\gamma_1 x_1 +\\zeta_1 \\\\\ny_2=\\beta_1 y_1 + \\gamma_2x_1 +\\zeta_2\n\\end{cases}\n\\]"
  },
  {
    "objectID": "chapter1.html#parameters-of-the-model",
    "href": "chapter1.html#parameters-of-the-model",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.4 Parameters of the model",
    "text": "1.4 Parameters of the model\n\nIn path modelling, we assume that the \\(\\zeta_\\bullet\\) errors are centered (ie zero mean) and we denote their variances by \\(\\sigma^2_\\bullet.\\)\nLet \\(\\theta=(\\gamma_1,\\beta_1,\\gamma_2,\\sigma_1,\\sigma_2)\\) the vector of parameters.\n\nWe can write the correlation matrix of the model \\[\n\\Sigma(\\theta)=\\left( \\begin{array}{ccc}\n1 & \\gamma1 & \\gamma_1\\beta_1+\\gamma_2 \\\\\n& \\gamma_1^2+\\sigma_1^2 & \\beta_1+\\gamma_1\\gamma_2 \\\\\n&  & \\gamma_2^2+\\beta_1^2+\\beta_1\\gamma_1\\gamma_2+\\sigma_2^2\n\\end{array}\n\\right)\n\\]"
  },
  {
    "objectID": "chapter1.html#covariance-analysis",
    "href": "chapter1.html#covariance-analysis",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.5 Covariance analysis",
    "text": "1.5 Covariance analysis\nWe denote by \\(S\\) the empirical correlation matrix. We look for the parameter \\(\\theta\\) such as\n\\[\n\\Sigma(\\theta) \\simeq S\n\\] For Ordinary Least Square minimization, the cost function is\n\\[F_{ULS}=\\frac1{2}\\Vert \\Sigma-S\\Vert^2=trace[(\\Sigma-S)^T.(\\Sigma-S)].\\]\nNumerical algoritm can be performed to estimate the solution of this problem."
  },
  {
    "objectID": "chapter1.html#general-problem-of-identification",
    "href": "chapter1.html#general-problem-of-identification",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.6 General problem of identification",
    "text": "1.6 General problem of identification\n\n\\(q\\) exogenous variables \\(x_1,...,x_q\\)\n\\(p\\) endogenous variables \\(y_1,...,y_p\\).\n\\(\\theta\\) vector of \\(t\\) parameters to be estimated.\n\nWe must have:\n\\[\nt\\leq\\frac{(p+q)(p+q+1)}{2}\n\\]"
  },
  {
    "objectID": "chapter1.html#jöreskog-formula",
    "href": "chapter1.html#jöreskog-formula",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.7 Jöreskog formula",
    "text": "1.7 Jöreskog formula\nThis formula provided an explicit form of the covariance matrix \\(\\Sigma(\\theta)\\) from the parameters \\(\\theta\\) of the Path-model."
  },
  {
    "objectID": "chapter1.html#maximum-likelihood-estimation",
    "href": "chapter1.html#maximum-likelihood-estimation",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.8 Maximum likelihood estimation",
    "text": "1.8 Maximum likelihood estimation\n\n\\((x_1,...,x_p,y_1,...,y_q)^T \\sim \\mathcal N (0,\\Sigma)\\), where \\(\\Sigma\\) is the covariance matrix of the variable \\(\\bf{x,y}\\).\n\\(\\Sigma\\) and \\(S\\) are positive-definite.\n\nWe define the log-likelihood function of the path model\n\\[F_{ML}(\\theta)=\\log|\\Sigma|+trace(S\\Sigma^{-1})-\\log|S|-(p+q).\\]"
  },
  {
    "objectID": "chapter1.html#properties",
    "href": "chapter1.html#properties",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.9 Properties",
    "text": "1.9 Properties"
  },
  {
    "objectID": "chapter1.html#the-cost-function-f_ml",
    "href": "chapter1.html#the-cost-function-f_ml",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.10 The cost function \\(F_{ML}\\)",
    "text": "1.10 The cost function \\(F_{ML}\\)\n\n\\(F_{ML}(S,\\Sigma(\\theta))\\geq 0,\\)\n\\(F_{ML}(S,\\Sigma(\\theta))= 0\\) if and only if \\(S= \\Sigma(\\theta)),\\)\n\\(F_{ML}\\) is continuous in \\(S\\) as well as in \\(Sigma(\\theta).\\)"
  },
  {
    "objectID": "chapter1.html#the-ml-estimator",
    "href": "chapter1.html#the-ml-estimator",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.11 The ML-estimator",
    "text": "1.11 The ML-estimator\n\nThe maximum of the function \\(F_{ML}\\) has no explicit expression, but it can be numerically estimated (see Jöreskog (1966)).\nAsymptotically, \\(\\widehat \\theta_{ML}\\) is unbiased, consistent, efficient (i.e. among the consistent estimators of \\(\\theta\\) it has the smallest asymptotic variance).\n\n\\(\\leadsto\\) Tests can be built using the previous property."
  },
  {
    "objectID": "chapter1.html#chi-square-test-of-model-fit",
    "href": "chapter1.html#chi-square-test-of-model-fit",
    "title": "1  Covariance Analysis for Path model",
    "section": "1.12 Chi-Square Test of Model Fit",
    "text": "1.12 Chi-Square Test of Model Fit\nIt tests the null hypothesis \\[H_0:\\Sigma(\\theta)=\\Sigma.\\] (i.e. implied covariance matrix equal to population covariance matrix) Under \\(H_0\\), its statistical is distributed from a chi-square with \\(df=\\frac{(p+q)(p+q+1)}{2}-t.\\)\nDrawback of the test: it tends to be highly powered with large samples i.e. null hypothesis is always rejected ….\n\\(\\leadsto\\) goodness of fit indices (GOF) have been introduced since 50 years.\n\nRelative GOF compare the implied model to a baseline model which assumes all the variables have variance but no covariance (for instance CFI,TLI).\nAbsolute GOF (for instance RMSEA).\n\n\n\n\n\nJöreskog, K. G. 1966. “SOME CONTRIBUTIONS TO MAXIMUM LIKELIHOOD FACTOR ANALYSIS*.” ETS Research Bulletin Series 1966 (2). https://doi.org/10.1002/j.2333-8504.1966.tb00539.x."
  },
  {
    "objectID": "chapter2.html#first-model",
    "href": "chapter2.html#first-model",
    "title": "2  Example in Lavaan",
    "section": "2.1 First model",
    "text": "2.1 First model\n\n\n\n\n\n\ndf&lt;-readxl::read_excel(\"data_PM.xlsx\") \nlibrary(lavaan)\n\nThis is lavaan 0.6-17\nlavaan is FREE software! Please report any bugs.\n\n\n\nmodel&lt;-\"\nY1~X1\nY2~Y1+X1\n\"\n\nfit1&lt;-sem(model,data=df)\n\nsummary(fit1)\n\nlavaan 0.6.17 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         5\n\n  Number of observations                           100\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  Y1 ~                                                \n    X1                1.004    0.048   20.880    0.000\n  Y2 ~                                                \n    Y1                2.018    0.210    9.592    0.000\n    X1                1.001    0.234    4.273    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n   .Y1                0.985    0.139    7.071    0.000\n   .Y2                4.360    0.617    7.071    0.000\n\n\nWe can compare the empirical covariance matrix:\n\nn&lt;-dim(df)[1]\nround(cov(df)*(n-1)/n,3)\n\n       Y1     Y2     X1\nY1  5.280 14.935  4.276\nY2 14.935 47.405 12.891\nX1  4.276 12.891  4.258\n\n\nto the fitted covariance matrix\n\nfitted(fit1)\n\n$cov\n       Y1     Y2     X1\nY1  5.280              \nY2 14.935 47.405       \nX1  4.276 12.891  4.258\n\n\n\n2.1.1 Remarks:\n\nThe degree of freedom of the model is 0 (6 parameters to be estimated from 6 observed values).\nWe can perform two OLS regression and we will find the same solutions.\n\nOne of the avantage of the Path-modelling is to test the existence of the indirect effect \\(I=\\gamma_1\\beta_1\\) of \\(\\xi_1\\) on \\(\\eta_2\\). In the following code, we define this inidrect effect through the symbol :=\n\nmodel&lt;-\"\nY1~g1*X1\nY2~b1*Y1+g2*X1\nI:=g1*b1\n\"\n\nfit1&lt;-sem(model,data=df)\nsummary(fit1)\n\nlavaan 0.6.17 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         5\n\n  Number of observations                           100\n\nModel Test User Model:\n                                                      \n  Test statistic                                 0.000\n  Degrees of freedom                                 0\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  Y1 ~                                                \n    X1        (g1)    1.004    0.048   20.880    0.000\n  Y2 ~                                                \n    Y1        (b1)    2.018    0.210    9.592    0.000\n    X1        (g2)    1.001    0.234    4.273    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n   .Y1                0.985    0.139    7.071    0.000\n   .Y2                4.360    0.617    7.071    0.000\n\nDefined Parameters:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n    I                 2.027    0.233    8.716    0.000"
  },
  {
    "objectID": "chapter2.html#second-model",
    "href": "chapter2.html#second-model",
    "title": "2  Example in Lavaan",
    "section": "2.2 Second model",
    "text": "2.2 Second model\nBuild on lavaan the model corresponding to this path diagram:\n\n\n\n\n\n\n\nSee the correction\nmodel&lt;-\"\nY1~a*X1\nY2~b*Y1\nI:=a*b\n\"\n\nfit1&lt;-sem(model,data=df)\nsummary(fit1)\n\n\nlavaan 0.6.17 ended normally after 1 iteration\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                         4\n\n  Number of observations                           100\n\nModel Test User Model:\n                                                      \n  Test statistic                                16.767\n  Degrees of freedom                                 1\n  P-value (Chi-square)                           0.000\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  Y1 ~                                                \n    X1         (a)    1.004    0.048   20.880    0.000\n  Y2 ~                                                \n    Y1         (b)    2.829    0.099   28.625    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n   .Y1                0.985    0.139    7.071    0.000\n   .Y2                5.156    0.729    7.071    0.000\n\nDefined Parameters:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n    I                 2.841    0.168   16.869    0.000"
  },
  {
    "objectID": "chapter3.html#latent-variables",
    "href": "chapter3.html#latent-variables",
    "title": "3  Covariance analysis for SEM",
    "section": "3.1 Latent variables",
    "text": "3.1 Latent variables\n\nLatent variables (or hidden variables) play a central role in a wide range of scientific fields, including psychology, medicine and economics.\nThese variables can not directly observed and can be inferred only indirectly from observable variables.\n\nExample: Intelligence of Children calculated from the fith WISC (Wechsler Intelligence Scale for Children)"
  },
  {
    "objectID": "chapter3.html#structure-of-a-sem",
    "href": "chapter3.html#structure-of-a-sem",
    "title": "3  Covariance analysis for SEM",
    "section": "3.2 Structure of a SEM",
    "text": "3.2 Structure of a SEM\n\nStructural model: linear relationship between latent variables.\nMeasurement model: linear relationship between a latent variable and its indicators."
  },
  {
    "objectID": "chapter3.html#example-of-sem",
    "href": "chapter3.html#example-of-sem",
    "title": "3  Covariance analysis for SEM",
    "section": "3.3 Example of SEM:",
    "text": "3.3 Example of SEM:\n\nThis study was carried out in the Nantes area in 2017.\nThe main issue of this study: Which psychological variables predict academic performances in mathematics and french?\n\nThree latent variables are involved in the model:\n\nrelationship with the teacher,\nself-efficacy feeling,\nacademic performance in mathematics."
  },
  {
    "objectID": "chapter3.html#diagram-of-the-model",
    "href": "chapter3.html#diagram-of-the-model",
    "title": "3  Covariance analysis for SEM",
    "section": "3.4 Diagram of the model:",
    "text": "3.4 Diagram of the model:"
  },
  {
    "objectID": "chapter3.html#structural-model-gray",
    "href": "chapter3.html#structural-model-gray",
    "title": "3  Covariance analysis for SEM",
    "section": "3.5 Structural model (gray)",
    "text": "3.5 Structural model (gray)\nA good relationship with the teacher (R.Ens) increases the self efficacy feeling (SEP) which, its turn, leads to better performances in mathematics.\n\n\n\\[\n\\begin{cases}\n\\eta_1=\\gamma_1 \\xi_1 +\\zeta_1 \\\\\n\\eta_2=\\beta_1 \\eta_1 + \\gamma_2\\xi_1 +\\zeta_2\n\\end{cases}\n\\] where \\(\\eta_\\bullet\\) denotes the endogenous variables and \\(\\xi_\\bullet\\) the exogenous variables.\n\n\n\n\n\n\n\\(\\eta_1:\\) self efficacy feeling, \\(\\eta_2:\\) math performance, \\(\\xi_1:\\) relationship with the teacher."
  },
  {
    "objectID": "chapter3.html#measurement-model",
    "href": "chapter3.html#measurement-model",
    "title": "3  Covariance analysis for SEM",
    "section": "3.6 Measurement model",
    "text": "3.6 Measurement model\nThree latent variables are involved in the model:\n\nrelationship with the teacher: five items were proposed to the children.\nself-efficacy feeling:"
  },
  {
    "objectID": "chapter3.html#example-of-items-for-the-relationship-with-the-teacher",
    "href": "chapter3.html#example-of-items-for-the-relationship-with-the-teacher",
    "title": "3  Covariance analysis for SEM",
    "section": "3.7 Example of items for the relationship with the teacher",
    "text": "3.7 Example of items for the relationship with the teacher\nI’m going to ask you some questions about yourself and about school. I want to know what you’re like when you’re at school. Let me explain these questions first. Each question is about two types of child and I want to know which one is more like you."
  },
  {
    "objectID": "chapter3.html#reflective-model",
    "href": "chapter3.html#reflective-model",
    "title": "3  Covariance analysis for SEM",
    "section": "3.8 Reflective model",
    "text": "3.8 Reflective model\nIn this model, we assume that latent variable predicts item covariances:\n\n\nExample: \\(\\xi_1\\) relationship with teacher measured by 5 items \\(x_1,...,x_5\\) on a Likert scale (i.e. level of agreement or disagreement with a statement) from 1 to 4 .\n\n\n\n\n\n\nObservable variables are written as:\n\\[\nx_i=\\lambda_{1i}\\xi_1+\\delta_i\n\\]"
  },
  {
    "objectID": "chapter3.html#usual-notations-in-covariance-analysis",
    "href": "chapter3.html#usual-notations-in-covariance-analysis",
    "title": "3  Covariance analysis for SEM",
    "section": "3.9 Usual notations in covariance analysis",
    "text": "3.9 Usual notations in covariance analysis\nLet \\(x_1,...,x_p\\) the observable variables corresponding to an exogenous latent variable \\(\\xi\\) and \\(y_1,...,y_p\\) the observable variables of an endogenous latent variable \\(\\eta\\).\n\nMeasurement model: \\[\n\\bf{y}=\\Lambda_y \\eta +\\varepsilon, \\quad\n\\bf{x}=\\Lambda_x \\xi +\\delta.\n\\]\nStructural model:\n\n\\[\\eta=\\bf{B}\\eta+\\Gamma\\xi+\\zeta.\\]"
  },
  {
    "objectID": "chapter3.html#assumptions",
    "href": "chapter3.html#assumptions",
    "title": "3  Covariance analysis for SEM",
    "section": "3.10 Assumptions",
    "text": "3.10 Assumptions\nThe assumptions on the latent variables are the same as those on the observed variables for path modelling."
  },
  {
    "objectID": "chapter3.html#gof-indices-in-sem",
    "href": "chapter3.html#gof-indices-in-sem",
    "title": "3  Covariance analysis for SEM",
    "section": "3.11 GOF indices in SEM",
    "text": "3.11 GOF indices in SEM\nThe most popular are CFI, TLI and RMSEA.\nThe relative GOF are often used to evaluate the measurement model while the absolute GOF evaluate the structural model."
  },
  {
    "objectID": "chapter4.html#more-difficult",
    "href": "chapter4.html#more-difficult",
    "title": "4  Application on Lavaan",
    "section": "4.1 More difficult",
    "text": "4.1 More difficult\nWe want to estimate the indirect effect of the two exogenous variables on math through the two mediators (TR and SEF).\nIt leads to estimate \\[Ind_{ij}=\\gamma_{ij}\\times \\beta_j,\\] where the regressions coefficients are define from the following equations\n\\[\n\\begin{cases}\nTR=\\gamma_{11}SE+\\gamma_{21}FS, \\\\\nSEF=\\gamma_{12}SE+\\gamma_{22}FS, \\\\\nMath=\\beta_1 TR+\\beta_2 SEF.\n\\end{cases}\n\\]\n\n\nSee the correction\nmodel&lt;-'\n#measurement model \nSEF=~SEF1+SEF2+SEF3\nTR=~TR1+TR2+TR3+TR4+TR5\nSE=~SE1+SE2+SE3+SE4+SE5\nFS=~FS1+FS2+FS3+FS4+FS5\n\nTR~g11*SE+g21*FS\nSEF~g12*SE+g22*FS\nMath~b1*SEF+b2*TR\n\nI11:=g11*b1\nI21:=g21*b1\nI12:=g11*b2\nI22:=g21*b2\n'\n\nfit&lt;-sem(model,data=df)\nsummary(fit)\n\n\nlavaan 0.6.17 ended normally after 56 iterations\n\n  Estimator                                         ML\n  Optimization method                           NLMINB\n  Number of model parameters                        44\n\n                                                  Used       Total\n  Number of observations                           291         295\n\nModel Test User Model:\n                                                      \n  Test statistic                               343.650\n  Degrees of freedom                               146\n  P-value (Chi-square)                           0.000\n\nParameter Estimates:\n\n  Standard errors                             Standard\n  Information                                 Expected\n  Information saturated (h1) model          Structured\n\nLatent Variables:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  SEF =~                                              \n    SEF1              1.000                           \n    SEF2              1.258    0.158    7.941    0.000\n    SEF3              0.482    0.087    5.549    0.000\n  TR =~                                               \n    TR1               1.000                           \n    TR2               0.905    0.099    9.186    0.000\n    TR3               0.835    0.098    8.530    0.000\n    TR4               0.705    0.087    8.145    0.000\n    TR5               0.389    0.089    4.383    0.000\n  SE =~                                               \n    SE1               1.000                           \n    SE2               1.232    0.205    6.001    0.000\n    SE3               1.209    0.211    5.740    0.000\n    SE4               1.395    0.235    5.949    0.000\n    SE5               1.467    0.236    6.219    0.000\n  FS =~                                               \n    FS1               1.000                           \n    FS2               0.582    0.095    6.151    0.000\n    FS3               0.900    0.123    7.298    0.000\n    FS4               1.092    0.144    7.586    0.000\n    FS5               1.187    0.151    7.873    0.000\n\nRegressions:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  TR ~                                                \n    SE       (g11)    1.161    0.272    4.271    0.000\n    FS       (g21)   -0.338    0.173   -1.951    0.051\n  SEF ~                                               \n    SE       (g12)    1.000    0.311    3.215    0.001\n    FS       (g22)   -0.356    0.217   -1.639    0.101\n  Math ~                                              \n    SEF       (b1)    0.240    0.085    2.813    0.005\n    TR        (b2)    0.378    0.118    3.199    0.001\n\nCovariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n  SE ~~                                               \n    FS                0.174    0.036    4.807    0.000\n\nVariances:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n   .SEF1              0.622    0.113    5.488    0.000\n   .SEF2              0.411    0.163    2.523    0.012\n   .SEF3              1.391    0.119   11.675    0.000\n   .TR1               0.354    0.050    7.102    0.000\n   .TR2               0.554    0.059    9.421    0.000\n   .TR3               0.644    0.063   10.158    0.000\n   .TR4               0.539    0.052   10.452    0.000\n   .TR5               0.806    0.069   11.744    0.000\n   .SE1               0.835    0.074   11.277    0.000\n   .SE2               0.544    0.053   10.210    0.000\n   .SE3               0.699    0.065   10.681    0.000\n   .SE4               0.742    0.072   10.322    0.000\n   .SE5               0.575    0.060    9.562    0.000\n   .FS1               0.742    0.069   10.715    0.000\n   .FS2               0.354    0.032   11.110    0.000\n   .FS3               0.399    0.040   10.016    0.000\n   .FS4               0.461    0.049    9.439    0.000\n   .FS5               0.398    0.047    8.479    0.000\n   .Math              1.396    0.118   11.806    0.000\n   .SEF               0.766    0.134    5.703    0.000\n   .TR                0.336    0.062    5.405    0.000\n    SE                0.197    0.057    3.476    0.001\n    FS                0.308    0.069    4.441    0.000\n\nDefined Parameters:\n                   Estimate  Std.Err  z-value  P(&gt;|z|)\n    I11               0.279    0.118    2.367    0.018\n    I21              -0.081    0.050   -1.615    0.106\n    I12               0.438    0.167    2.632    0.008\n    I22              -0.128    0.076   -1.686    0.092"
  },
  {
    "objectID": "chapter4.html#focus-on-the-measurement-model",
    "href": "chapter4.html#focus-on-the-measurement-model",
    "title": "4  Application on Lavaan",
    "section": "4.2 Focus on the measurement model",
    "text": "4.2 Focus on the measurement model\nIn this part, we forget the structural model and we focus only on the measurement model. The first question is to check that the measures of the latent variables are consistent with the way the researcher understands those latent variables (e.g. we check that the items SEF1, SEF2, SFE3 are really associated with SEF).\n\nmodel0&lt;-'\n#measurement model \nSEF=~SEF1+SEF2+SEF3\nTR=~TR1+TR2+TR3+TR4+TR5\nSE=~SE1+SE2+SE3+SE4+SE5\nFS=~FS1+FS2+FS3+FS4+FS5\n'\n\nThis is conformatory factor analysis (CFA).\n\nfit0&lt;-cfa(model0,data=df,meanstructure=T)\n\nThe consistency of the construction of latent variable is based on GOF indices, we must have\n\n\\(CFI&gt;0.90\\),\n\\(TLI&gt;0.90\\),\n\\(RMSEA &lt; 0.08\\).\n\n\nfitmeasures(fit0)\n\n                 npar                  fmin                 chisq \n               60.000                 0.417               242.418 \n                   df                pvalue        baseline.chisq \n              129.000                 0.000              1416.517 \n          baseline.df       baseline.pvalue                   cfi \n              153.000                 0.000                 0.910 \n                  tli                  nnfi                   rfi \n                0.894                 0.894                 0.797 \n                  nfi                  pnfi                   ifi \n                0.829                 0.699                 0.912 \n                  rni                  logl     unrestricted.logl \n                0.910             -6747.308             -6626.099 \n                  aic                   bic                ntotal \n            13614.615             13835.015               291.000 \n                 bic2                 rmsea        rmsea.ci.lower \n            13644.742                 0.055                 0.044 \n       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue \n                0.066                 0.900                 0.214 \n       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 \n                0.050                 0.000                 0.080 \n                  rmr            rmr_nomean                  srmr \n                0.071                 0.075                 0.069 \n         srmr_bentler   srmr_bentler_nomean                  crmr \n                0.069                 0.073                 0.073 \n          crmr_nomean            srmr_mplus     srmr_mplus_nomean \n                0.077                 0.069                 0.073 \n                cn_05                 cn_01                   gfi \n              188.873               204.203                 0.989 \n                 agfi                  pgfi                   mfi \n                0.984                 0.675                 0.823 \n                 ecvi \n                1.245"
  },
  {
    "objectID": "chapter4.html#invariance-of-the-measurement-model",
    "href": "chapter4.html#invariance-of-the-measurement-model",
    "title": "4  Application on Lavaan",
    "section": "4.3 Invariance of the measurement model",
    "text": "4.3 Invariance of the measurement model\nAll the issues of this section are extracted from .\nLet’s look at the question of the difference in self-efficacy feeling between boys and girls. The most common way to do this is to compare group means by a Student test. But, this requires that\n\nboys and girls understand and react similarly to the questions,\nthe response models should be invariant across gender.\n\nTo assess these assumptions, the measurement models are tested against an increasing number of constraints. All these models are nested.\nFisrt step: Configural model. The invariance of the model form is checked: do the latent variables follow the same pattern across genders? (i.e. same items are associated with same latent variables for boys and girls).\n\nfit_config&lt;-cfa(model0,data=df,group=\"gender\",meanstructure=T)\nfitmeasures(fit_config)\n\n                 npar                  fmin                 chisq \n              120.000                 0.665               387.086 \n                   df                pvalue        baseline.chisq \n              258.000                 0.000              1492.165 \n          baseline.df       baseline.pvalue                   cfi \n              306.000                 0.000                 0.891 \n                  tli                  nnfi                   rfi \n                0.871                 0.871                 0.692 \n                  nfi                  pnfi                   ifi \n                0.741                 0.624                 0.895 \n                  rni                  logl     unrestricted.logl \n                0.891             -6660.526             -6466.983 \n                  aic                   bic                ntotal \n            13561.051             14001.850               291.000 \n                 bic2                 rmsea        rmsea.ci.lower \n            13621.305                 0.059                 0.046 \n       rmsea.ci.upper        rmsea.ci.level          rmsea.pvalue \n                0.070                 0.900                 0.121 \n       rmsea.close.h0 rmsea.notclose.pvalue     rmsea.notclose.h0 \n                0.050                 0.001                 0.080 \n                  rmr            rmr_nomean                  srmr \n                0.081                 0.085                 0.081 \n         srmr_bentler   srmr_bentler_nomean                  crmr \n                0.081                 0.085                 0.085 \n          crmr_nomean            srmr_mplus     srmr_mplus_nomean \n                0.090                 0.081                 0.085 \n                cn_05                 cn_01                   gfi \n              223.875               236.880                 0.986 \n                 agfi                  pgfi                   mfi \n                0.980                 0.673                 0.801 \n                 ecvi \n                2.155 \n\n\nAccording to the criteria defined above for the GOF indices, this model is acceptable. However, it is necessary to check that it fits the data as well as the model without gender. As these two models are nested, the difference between them can be assessed on the basis of the significance of the change in \\(\\chi^2.\\).\n\nlavTestLRT(fit0,fit_config)\n\n\n\n  \n\n\n\nHowever, as usually this test is sensible to the sample size, thus alternative fit indices comparisons are used in application. The differences in CFI (\\(\\Delta CFI\\)) and RMSEA (\\(\\Delta RMSEA\\)) are the most commonly used and may not exceed 0.01 in absolute value.\n\nfitmeasures(fit_config)[\"cfi\"]-fitmeasures(fit0)[\"cfi\"]\n\n        cfi \n-0.01906258 \n\nfitmeasures(fit_config)[\"rmsea\"]-fitmeasures(fit0)[\"rmsea\"]\n\n      rmsea \n0.003673898 \n\n\n\n4.3.1 Constraints on measurement model parameters\nFor all the latent of the configural model, the following diagram describes the measurement model:\n Second step: Weak invariance (or metric invariance). If weak invariance is supported, the equivalence of the item loadings on the latent variable is tested. Metric invariance means that each item contributes to the latent construct to a similar degree across groups. With previous notations the null hypothesis is \\[\n\\begin{cases}\n\\lambda^g_1=\\lambda^b_1, \\\\\n\\lambda^g_2=\\lambda^b_2, \\\\\n\\dots\n\\end{cases}\n\\]\n\nfit_weak&lt;-cfa(model0,data=df,group=\"gender\",group.equal=\"loadings\")\n\n\nlavTestLRT(fit_config,fit_weak)\n\n\n\n  \n\n\nfitmeasures(fit_config)[\"cfi\"]-fitmeasures(fit_weak)[\"cfi\"]\n\n        cfi \n0.004197831 \n\nfitmeasures(fit_config)[\"rmsea\"]-fitmeasures(fit_weak)[\"rmsea\"]\n\n      rmsea \n0.000437986 \n\n\nThird step: Strong invariance (or scalar invariance). If weak invariance is supported, the equivalence of the item intercept on the latent variable is tested. Scalar invariance means that mean differences in the latent construct capture all mean differences in the shared variance of the items. With previous notations the null hypothesis is\n\\[\n\\begin{cases}\ni^g_1=i^b_1, \\\\\ni^g_2=i^b_2, \\\\\n\\dots\n\\end{cases}\n\\]\n\nfit_strong&lt;-cfa(model0,data=df,group=\"gender\",group.equal=c(\"loadings\",\"intercepts\"))\n\n\nlavTestLRT(fit_weak,fit_strong)\n\n\n\n  \n\n\nfitmeasures(fit_strong)[\"cfi\"]-fitmeasures(fit_weak)[\"cfi\"]\n\n        cfi \n-0.01402527 \n\nfitmeasures(fit_strong)[\"rmsea\"]-fitmeasures(fit_weak)[\"rmsea\"]\n\n      rmsea \n0.001976347 \n\n\nStrong invariance cannot be supported. To improve the fit of the model, we can assume that strong invariance is true, with the exception of some items that need to be identified.\n\nparameterestimates(fit_weak)%&gt;%filter(op==\"~1\"&group==\"1\"&est!=0)\n\n\n\n  \n\n\nparameterestimates(fit_weak)%&gt;%filter(op==\"~1\"&group==\"2\"&est!=0)\n\n\n\n  \n\n\n\nLet consider the difference in intercept estimations :\n\ntab1&lt;-parameterestimates(fit_weak)%&gt;%filter(op==\"~1\"&group==\"1\"&est!=0)\ntab2&lt;-parameterestimates(fit_weak)%&gt;%filter(op==\"~1\"&group==\"2\"&est!=0)\ndiff&lt;-tab1[,\"est\"]-tab2[,\"est\"]\nnames(diff)&lt;-tab1$lhs\ndiff\n\n      SEF1       SEF2       SEF3        TR1        TR2        TR3        TR4 \n0.02743321 0.37953244 0.37003817 0.21879771 0.13573473 0.26216603 0.11894084 \n       TR5        SE1        SE2        SE3        SE4        SE5        FS1 \n0.14751908 0.50725191 0.13382634 0.53392176 0.44518130 0.38645038 0.44160305 \n       FS2        FS3        FS4        FS5 \n0.30152672 0.27733779 0.42461832 0.48296756 \n\n\nRemoving the equality constraint on items can be achieved using group.partial\n\nfit_strong2&lt;-cfa(model0,data=df,group=\"gender\",group.equal=c(\"loadings\",\"intercepts\"),group.partial=\"SE4~1\")\nlavTestLRT(fit_weak,fit_strong2)\n\n\n\n  \n\n\nfitmeasures(fit_strong2)[\"cfi\"]-fitmeasures(fit_weak)[\"cfi\"]\n\n        cfi \n-0.01478964 \n\nfitmeasures(fit_strong2)[\"rmsea\"]-fitmeasures(fit_weak)[\"rmsea\"]\n\n      rmsea \n0.002262904 \n\nfit_strong3&lt;-cfa(model0,data=df,group=\"gender\",group.equal=c(\"loadings\",\"intercepts\"),group.partial=c(\"SE2~1\",\"SE4~1\"))\nlavTestLRT(fit_weak,fit_strong3)\n\n\n\n  \n\n\nfitmeasures(fit_strong3)[\"cfi\"]-fitmeasures(fit_weak)[\"cfi\"]\n\n         cfi \n-0.009050069 \n\nfitmeasures(fit_strong3)[\"rmsea\"]-fitmeasures(fit_weak)[\"rmsea\"]\n\n       rmsea \n0.0009936305"
  },
  {
    "objectID": "chapter4.html#moderation-modelling",
    "href": "chapter4.html#moderation-modelling",
    "title": "4  Application on Lavaan",
    "section": "4.4 Moderation modelling",
    "text": "4.4 Moderation modelling\nIn this section we look for gender invariance in the mediation model examined above. More specifically, is this mediation model the same for male and female students?\n\nmodel0&lt;-'\n# measurement model \nSEF=~SEF1+SEF2+SEF3\nTR=~TR1+TR2+TR3+TR4+TR5\nSE=~SE1+SE2+SE3+SE4+SE5\nFS=~FS1+FS2+FS3+FS4+FS5\n\n# structural model\nSEF~SE+FS\nTR~SE+FS\nMath~SEF+TR\n\n# constraint\nTR~~0*TR\n'\n\nfit0&lt;-sem(model0,data=df,group=\"gender\",group.equal=c(\"loadings\",\"intercepts\",\"regressions\"),group.partial=c(\"SE2~1\",\"SE4~1\"))\n\nfit1&lt;-sem(model0,data=df,group=\"gender\",group.equal=c(\"loadings\",\"intercepts\"),group.partial=c(\"SE2~1\",\"SE4~1\"))\n\nlavTestLRT(fit0,fit1)"
  }
]